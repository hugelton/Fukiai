<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Fukiai : Musical Icon Fonts</title>
		<link rel="stylesheet" href="style.css" />
		<style>
			@font-face {
				font-family: 'Fukiai';
				src: url('fukiai.woff') format('woff'),
				     url('fukiai.ttf') format('truetype');
				font-weight: normal;
				font-style: normal;
			}
			.glyph-char {
				font-family: 'Fukiai';
			}
		</style>
	</head>
	<body>
		<header>
			<h1>Fukiai : Musical Icon Fonts</h1>
			<p><a href="https://github.com/hugelton/Fukiai">GitHub</a></p>
			<input type="text" id="search" placeholder="Filter icons..." />
    {{category_links}}
		</header>

		<main>{{glyph_blocks}}</main>

		<div id="copied-notice">Copied to clipboard</div>

		<footer>
			<p>
				By Leo Kuroshita for
				<a href="https://hugelton.com">Hügelton Instruments</a>, Kōbe, Japan.
			</p>
		</footer>

		<script>
			const search = document.getElementById("search");
			const glyphs = document.querySelectorAll(".glyph");

			search.addEventListener("input", () => {
				const q = search.value.toLowerCase();
				glyphs.forEach((el) => {
					const name = el.dataset.name?.toLowerCase() || "";
					el.style.display = name.includes(q) ? "" : "none";
				});
			});

    // コピー＆通知（要素ごとにコピー内容を分離）
    const notice = document.getElementById("copied-notice");
    function showNotice(text) {
      notice.textContent = text || 'Copied to clipboard';
      notice.classList.add('show');
      clearTimeout(window.__copyTimer);
      window.__copyTimer = setTimeout(() => notice.classList.remove('show'), 1200);
    }

    // アイコンクリックで実体をコピー
    document.addEventListener('click', (e) => {
      const icon = e.target.closest('.glyph-char');
      if (icon) {
        const content = icon.textContent;
        navigator.clipboard.writeText(content).then(() => showNotice('Copied entity'));
        return;
      }
      const badge = e.target.closest('.badge');
      if (badge) {
        const value = badge.dataset.copy || badge.textContent;
        navigator.clipboard.writeText(value).then(() => {
          if (badge.classList.contains('copy-name')) showNotice(`Copied name: ${value}`);
          else if (badge.classList.contains('copy-class')) showNotice(`Copied class: ${value}`);
          else if (badge.classList.contains('copy-unicode')) showNotice(`Copied unicode: ${value}`);
          else showNotice('Copied');
        });
      }
    });
		</script>
	</body>
</html>
